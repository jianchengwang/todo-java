其实原子类性能高的秘密很简单，硬件支持而已。
CPU 为了解决并发问题，提供了 CAS 指令（CAS，全称是 Compare And Swap，即“比较并交换”）。
CAS 指令包含 3 个参数：共享变量的内存地址 A、用于比较的值 B 和共享变量的新值 C；并且只有当内存中地址 A 处的值等于 B 时，才能将内存中地址 A 处的值更新为新值 C。作为一条 CPU 指令，CAS 指令本身是能够保证原子性的。

底层硬件层面通过汇编指令lock_cmpxhg实现原子性

虽然cas能够保证原子性和可见性，但是在进行cas指令之前，我期望的值已经变了，那么就不能够实现swap操作。 
这个时候业务系统如果要保证这次操作一定是要完成的，而不管时序的问题，那么只能通过不断尝试，指导完成swap操作才结束（自旋操作，内核态也有自旋锁）

